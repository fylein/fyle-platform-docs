reconciliation_transaction_out:
  type: object
  additionalProperties: false
  required:
    - id
    - org_id
    - reconciliation_entry_id
    - corporate_card_id
    - statement_amount
    - statement_merchant
    - matched_expenses_count
    - is_reconciled
    - is_ignored
    - expenses
  properties:
    id:
      $ref: './fields.yaml#/id_string'
      example: rectx8abc123
      description: Unique id of the reconciliation transaction.
    org_id:
      $ref: './fields.yaml#/org_id'
      description: Organization id to which this reconciliation transaction belongs.
    reconciliation_entry_id:
      $ref: './fields.yaml#/id_string'
      example: receabc12345
      description: Reconciliation entry id that this transaction is associated with.
    corporate_card_id:
      $ref: './fields.yaml#/id_string'
      example: bawownwrng
      description: Corporate card id for which this statement transaction was received.
    statement_line_item_id:
      allOf:
        - $ref: './fields.yaml#/fk_string'
      nullable: true
      example: stliabc123
      description: Statement line item id corresponding to this transaction (nullable).
    expense_ids:
      type: array
      items:
        $ref: './fields.yaml#/id_string'
      example: [ 'txwownwrng', 'txuXDH16HzK' ]
      description: List of matched expense ids. Can be an empty array when not matched.
    statement_amount:
      $ref: './fields.yaml#/amount'
      example: 33.45
      description: Amount present on the card statement for this transaction.
    statement_merchant:
      type: string
      example: AMexon
      description: Merchant name as present on the card statement.
    statement_transaction_date:
      allOf:
        - $ref: './fields.yaml#/timestamptz_utc'
      nullable: true
      description: Transaction date as present on the statement (nullable).
    statement_post_date:
      allOf:
        - $ref: './fields.yaml#/timestamptz_utc'
      nullable: true
      description: Post date as present on the statement (nullable).
    matched_expenses_count:
      type: integer
      example: 3
      description: Number of expenses matched to this statement transaction.
    expenses:
      type: array
      items:
        $ref: '#/reconciliation_matched_expense_out_embed'
      description: | 
        List of matched expenses. Can be an empty array when there are no expenses.
    is_reconciled:
      type: boolean
      example: false
      description: Indicates whether the statement transaction is reconciled.
    is_ignored:
      type: boolean
      example: false
      description: Indicates whether the statement transaction is ignored from reconciliation.
    created_at:
      $ref: './fields.yaml#/created_at'
      description: Timestamp when this reconciliation transaction record was created.
    updated_at:
      $ref: './fields.yaml#/updated_at'
      description: Timestamp when this reconciliation transaction record was last updated.

reconciliation_expense_split_out_embed:
  type: object
  additionalProperties: false
  required:
    - id
    - amount
    - state
    - purpose
  properties:
    id:
      allOf:
        - $ref: './fields.yaml#/id_string'
      example: txwownwrng
      description: Expense id of the split line.
    amount:
      allOf:
        - $ref: './fields.yaml#/amount'
      nullable: true
      description: Amount of this split line in organization currency.
    currency:
      allOf:
        - $ref: './fields.yaml#/currency'
      nullable: true
      description: Currency of this split line amount (organization currency).
      example: USD
    merchant:
      allOf:
        - $ref: './fields.yaml#/merchant'
      nullable: true
      description: Merchant associated with this split, if any.
    spent_at:
      allOf:
        - $ref: './fields.yaml#/timestamptz_utc'
      nullable: true
      description: Spent date of this split line (nullable).
    state:
      type: string
      enum:
        - COMPLETE
        - DRAFT
        - PAID
        - PAYMENT_PROCESSING
        - APPROVER_PENDING
        - PAYMENT_PENDING
        - APPROVED
        - UNREPORTABLE
      description: The state of the Expense.
    file_ids:
      type: array
      items:
        $ref: './fields.yaml#/id_string'
      description: List of file IDs attached to the expense split
      example: ['figwiwpjww', 'figwiwpjwx']
    category:
      allOf:
        - $ref: './fields.yaml#/category_display_name'
      description: Category display name of the split expense
      nullable: true
      example: Travel
    project:
      allOf:
        - $ref: './fields.yaml#/project_display_name'
      description: Project display name of the split expense
      nullable: true
      example: ACME / Expansion
    purpose:
      type: string
      nullable: true
      example: Team lunch
      description: Purpose or description of this split line.

reconciliation_matched_expense_out_embed:
  type: object
  additionalProperties: false
  required:
    - id
    - amount
    - merchant
    - spent_at
    - state
    - file_ids
    - category
    - project
    - purpose
    - splits
  properties:
    id:
      allOf:
        - $ref: './fields.yaml#/id_string'
      example: txuXDH16HzK
      description: Expense id.
    amount:
      allOf:
        - $ref: './fields.yaml#/amount'
      nullable: true
      example: 33.45
      description: Expense amount in organization currency (nullable).
    currency:
      allOf:
        - $ref: './fields.yaml#/currency'
      nullable: true
      example: USD
      description: Currency of the expense amount (organization currency).
    merchant:
      allOf:
        - $ref: './fields.yaml#/merchant'
      nullable: true
      example: AMexon
      description: Merchant associated with the expense, if any.
    spent_at:
      allOf:
        - $ref: './fields.yaml#/timestamptz_utc'
      nullable: true
      description: Date when the expense was made (nullable).
    state:
      type: string
      enum:
        - COMPLETE
        - DRAFT
        - PAID
        - PAYMENT_PROCESSING
        - APPROVER_PENDING
        - PAYMENT_PENDING
        - APPROVED
        - UNREPORTABLE
      description: The state of the Expense.
    file_ids:
      type: array
      items:
        $ref: './fields.yaml#/id_string'
      description: List of file IDs attached to the expense
      example: ['figwiwpjww', 'figwiwpjwx']
    category:
      allOf:
        - $ref: './fields.yaml#/category_display_name'
      description: Category display name of the expense
      nullable: true
      example: Travel
    project:
      allOf:
        - $ref: './fields.yaml#/project_display_name'
      description: Project display name of the expense
      nullable: true
      example: ACME / Expansion
    purpose:
      type: string
      nullable: true
      example: Team lunch
      description: Purpose or description of the expense.
    splits:
      type: array
      description: List of split expenses. Empty when the expense is not split.
      items:
        $ref: '#/reconciliation_expense_split_out_embed'

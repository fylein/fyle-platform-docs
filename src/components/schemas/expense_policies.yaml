expense_policy_in:
  type: object
  required:
    - source
    - description
  additionalProperties: False
  properties:
    id:
      allOf:
        - $ref: ./fields.yaml#/id_string
      description: |
        This represents the id of the expense policy.<br><br>
        _Note: When creating the policy, this field shouldn't be set._<br>
        _When updating, this field should be set._
      example: 'tpr12345xyz'
    description:
      allOf:
        - $ref: ./fields.yaml#/description
      nullable: false
      description: |
        This represents the description of the expense policy.
      example: Receipt is mandatory for expense above $50
    source:
      $ref: ./fields.yaml#/expense_policy_source
    expense_limit_type:
      $ref: ./fields.yaml#/expense_policy_limit_type
    expense_currency:
      allOf:
        - $ref: ./fields.yaml#/currency
      description: |
        The three-letter currency code following ISO standard <a
        href='https://www.iso.org/iso-4217-currency-codes.html'>ISO 4217</a>.<br>
        _Note: When this field is set, expense_amount_max or expense_amount_min must be set._
    expense_amount_max:
      allOf:
        - $ref: ./fields.yaml#/amount
      description: |
        Maximum amount above which policy will be violated.<br>
        _Note: When this field is set, expense_currency must be set._
      example: 10000
    expense_amount_min:
      allOf:
        - $ref: ./fields.yaml#/amount
      description: |
        Minimum amount below which policy will be violated.<br>
        _Note: When this field is set, expense_currency must be set._
      example: 500
    expense_distance_max:
      allOf:
        - $ref: ./fields.yaml#/distance
      description: |
        Maximum travel distance allowed, above which policy will be violated.<br>
        _Note: expense_category_ids must be set with mileage categories._
      example: 10000
    expense_distance_min:
      allOf:
        - $ref: ./fields.yaml#/distance
      description: |
        Minimum travel distance allowed, below which policy will be violated.<br> 
        _Note: expense_category_ids must be set with mileage categories._
      example: 500
    expense_category_ids:
      type: array
      items:
        $ref: './fields.yaml#/id_integer'
      description: |
          List of category ids targeted by this policy. <br><br>
          _Note: To include these categories set expense_category_ids_op to IN_<br>
          _To exclude these categories set expense_category_ids_op to NOT_IN_<br>
      example: [2222, 1221]
    expense_category_ids_op:
      allOf:
        - $ref: ./fields.yaml#/in_operator
      description: |
          _Note: This field is mandatory if the field expense_category_ids is present in the request body._
    expense_project_ids:
      type: array
      items:
        $ref: './fields.yaml#/id_integer'
      description: |
        List of project ids targeted by this policy. <br><br>
        _Note: To include these projects set expense_project_ids_op to IN_<br>
        _To exclude these projects set expense_project_ids_op to NOT_IN_<br>
      example: [1234, 5678]
    expense_project_ids_op:
      allOf:
        - $ref: ./fields.yaml#/in_operator
      description: |
          _Note: This field is mandatory if the field expense_project_ids is present in the request body._
    expense_cost_center_ids:
      type: array
      items:
        $ref: './fields.yaml#/id_integer'
      description: |
        List of cost centers ids targeted by this policy. <br><br>
        _Note: To include these cost centers set expense_cost_center_ids_op to IN_<br>
        _To exclude these cost centers set expense_cost_center_ids_op to NOT_IN_<br>
      example: [1987, 3456]
    expense_cost_center_ids_op:
      allOf:
        - $ref: ./fields.yaml#/in_operator
      description: |
          _Note: This field is mandatory if the field expense_cost_center_ids is present in the request body._
    expense_allowed_exchange_rate_difference_percentage:
      type: number
      description: |
        Allowed percentage difference for exchange rates above which policy will be violated.
      example: 10
      minimum: 0
      maximum: 100
    expense_allowed_distance_difference_percentage:
      type: number
      description: |
        Allowed percentage difference for travel distance above which policy will be violated.<br>
        _Note: expense_category_ids must be set with mileage categories._
      example: 8
      minimum: 0
      maximum: 100
    expense_custom_fields:
      allOf:
        - $ref: './fields.yaml#/custom_fields'
      description: |
        Custom fields (if any)<br>
        _Example -> "No of days": 5_
    expense_custom_fields_op:
      type: object
      description: |
        Operator for the expense_custom_fields. <br>
        _Format -> field_name: operator_ <br>
        _Example -> "No of days": "GREATER_THAN_EQUAL_TO"_ <br><br>
        Supported values based on field type: <br>
        `Boolean`: "IS, NOT_IS" <br>
        `Date`: "LESS_THAN_EQUAL_TO, GREATER_THAN_EQUAL_TO" <br>
        `Location`: "IN, NOT_IN" <br>
        `Number`: "LESS_THAN_EQUAL_TO, GREATER_THAN_EQUAL_TO" <br>
        `String`: "CONTAINS, EQUALS" <br>
        `Select`: "IN, NOT_IN"<br>
        _Note: This field is mandatory if the field expense_custom_fields is present in the request body._
      properties:
        field_name:
          type: string
    expense_locations:
      description: |
        This field will be present for travel related categories.
        For travel between Place A to Place B, this array will contain two items, From location at array index 0 and To location at array index 1.
      type: array
      items:
        $ref: './fields.yaml#/location'
    expense_locations_op:
      allOf:
        - $ref: ./fields.yaml#/in_operator
      description: |
          _Note: This field is mandatory if the field expense_locations is present in the request body._
    expense_creation_delay_days_max:
      type: number
      example: 12
      description: |
        No of days from spent date after which if expense is created will violate policy.
    expense_on_holiday_allowed:
      type: boolean
      description: |
        Is expense on holiday allowed.<br>
        _Default True._
      example: True
    expense_without_receipt_allowed:
      type: boolean
      description: |
        Is expense without receipt allowed.<br>
        _Default True._
      example: True
    expense_spent_at_max:
      allOf:
        - $ref: './fields.yaml#/timestamptz_pst'
      description: |
        Expense having spent date greater than this date will violate policy.
    expense_spent_at_min:
      allOf:
        - $ref: './fields.yaml#/timestamptz_pst'
      description: |
        Expense having spent date lesser than this date will violate policy.
    expense_payment_modes:
      allOf:
        - $ref: ./fields.yaml#/policy_payment_modes
      description: |
        Payment mode for expense to be targeted in the policy.
    expense_payment_modes_op:
      allOf:
        - $ref: ./fields.yaml#/in_operator
      description: |
          _Note: This field is mandatory if the field expense_payment_modes is present in the request body._
    expense_without_ccc_match_allowed:
      type: boolean
      description: |
        Is expense without Corporate Credit Card transaction match allowed.<br>
        _Default True._
      example: True
    expense_include_foreign_currency:
      type: boolean
      description: |
        Should policy run on expenses created in foreign currency.<br>
        _Default False._
      example: True
    expense_flight_travel_class:
      $ref: ./fields.yaml#/expense_policy_flight_travel_classes
    expense_train_travel_class:
      type: array
      description: >
        This field is applicable only for Train category.

        Index 0 holds onward journey travel class, index 1 holds return journey
        travel class.
      items:
        type: string
      example:
        - AC First Class
        - Second Sitting
    fiscal_year_start_month:
      type: number
      description: | 
        Month number of start of fiscal year.<br>
        _Note: This fields is required when expense_limit_type is QUARTERLY, HALF_YEARLY or YEARLY._
      example: 4
      minimum: 1
      maximum: 12
    expense_vehicle_type:
      allOf:
        - $ref: ./fields.yaml#/vehicle_type
      description: |
        Vehicle type targeted by this policy.
    expense_annual_distance_max:
      type: number
      example: 1200
      description: |
        Maximum travel distance allowed, above which policy will be violated.<br>
        _Note: expense_category_ids must be set with mileage categories._
    employee_level_ids:
      type: array
      description: |
        Employee level ids targeted by this policy.
      items:
        type: string
      example:
        - lvl1sdfad
        - lvl2sdfas
    employee_level_ids_op:
      allOf:
        - $ref: ./fields.yaml#/in_operator
      description: |
          _Note: This field is mandatory if the field employee_level_ids is present in the request body._
    employee_custom_fields:
      allOf:
        - $ref: './fields.yaml#/custom_fields'
      description: |
        Custom fields (if any)<br>
        _Example -> "Employee Age": 30_
    employee_custom_fields_op:
      type: object
      description: |
        Operator for the employee_custom_fields. <br>
        _Format -> field_name: operator_ <br>
        _Example -> "Employee Age": "GREATER_THAN_EQUAL_TO"_ <br><br>
        Supported values based on field type: <br>
        `Boolean`: "IS, NOT_IS" <br>
        `Date`: "LESS_THAN_EQUAL_TO, GREATER_THAN_EQUAL_TO" <br>
        `Location`: "IN, NOT_IN" <br>
        `Number`: "LESS_THAN_EQUAL_TO, GREATER_THAN_EQUAL_TO" <br>
        `String`: "CONTAINS, EQUALS" <br>
        `Select`: "IN, NOT_IN"<br>
        _Note: This field is mandatory if the field employee_custom_fields is present in the request body._
      properties:
        field_name:
          type: string
    employee_department_ids:
      type: array
      description: |
        Employee department ids targeted by this policy.
      items:
        type: string
      example:
        - dept1asdfa
        - dept2adfad
    employee_department_id_op:
      allOf:
        - $ref: ./fields.yaml#/in_operator
      description: |
          _Note: This field is mandatory if the field employee_department_ids is present in the request body._
    employee_locations:
      description: |
        Location of employees targeted by this policy.
      type: array
      items:
        $ref: './fields.yaml#/location'
    employee_locations_op:
      allOf:
        - $ref: ./fields.yaml#/in_operator
      description: |
          _Note: This field is mandatory if the field employee_locations is present in the request body._
    employee_user_ids:
      type: array
      description: |
        Employee user ids targeted by this policy.
      items:
        type: string
      example:
        - usabcds1
        - usabcds2
    employee_user_ids_op:
      allOf:
        - $ref: ./fields.yaml#/in_operator
      description: |
          _Note: This field is mandatory if the field employee_user_ids is present in the request body._
    employee_titles:
      type: array
      description: |
        Employee titles targeted by this policy.
      items:
        type: string
      example:
        - CEO
        - Manager
    employee_titles_op:
      allOf:
        - $ref: ./fields.yaml#/in_operator
      description: |
          _Note: This field is mandatory if the field employee_titles is present in the request body._
    action_flag:
      type: boolean
      description: |
        Whether to flag the expense when it violates policy.<br>
        _Default False._
      example: True
    action_show_warning:
      type: boolean
      description: |
        Whether to show warning to employee when the expense that they are creating violates the policy.<br>
        _Default False._
      example: True
    action_make_unreportable:
      type: boolean
      description: |
        Whether to make the expense unreportable when it violates policy. <br>
        (Expense will be created but employee will not be able to add it to report).<br>
        _Default False._
      example: True
    action_remove_employee_approver1:
      type: boolean
      description: |
        Whether to remove the primary approver from the report when the expense violates policy.<br>
        _Default False._
      example: True
    action_add_employee_approver2:
      type: boolean
      description: |
        Whether to add secondary approver 1 as approver to report when the expense violates policy.<br>
        _Default False._
      example: True
    action_add_employee_approver3:
      type: boolean
      description: |
        Whether to add secondary approver 2 as approver to report when the expense violates policy.<br>
        _Default False._
      example: True
    action_add_project_approver1:
      type: boolean
      description: |
        Whether to add project approver 1 as approver to report when the expense violates policy.<br>
        _Default False._
      example: True
    action_add_project_approver2:
      type: boolean
      description: |
        Whether to add project approver 2 as approver to report when the expense violates policy.<br>
        _Default False._
      example: True
    action_add_department_head_approver:
      type: boolean
      description: |
        Whether to add department head as approver to report when the expense violates policy.<br>
        _Default False._
      example: True
    action_cap_amount:
      type: boolean
      description: |
        Whether to cap the amount to expense_amount_max when the expense violates policy.<br>
        _Default False._
      example: True
    action_add_approver_user_ids:
      type: array
      description: |
        List of approver user ids to be added to report when the expense violates policy.
      items:
        type: string
      example:
        - usabcds3
        - usabcds4
    action_override_distance_slab_rate:
      type: number
      description: |
        Override the distance slab rate with the set value when the expense violates policy.
      example: 20

expense_policy_out:
  type: object
  required:
    - source
    - description
  additionalProperties: False
  properties:
    id:
      allOf:
        - $ref: ./fields.yaml#/id_string
      description: |
        This represents the id of the expense policy.
      example: 'tpr12345xyz'
    description:
      allOf:
        - $ref: ./fields.yaml#/description
      nullable: false
      description: |
        This represents the description of the expense policy.
      example: Receipt is mandatory for expense above $50
    source:
      $ref: ./fields.yaml#/expense_policy_source
    expense_limit_type:
      $ref: ./fields.yaml#/expense_policy_limit_type
    expense_currency:
      allOf:
        - $ref: ./fields.yaml#/currency
      description: |
        The three-letter currency code following ISO standard <a
        href='https://www.iso.org/iso-4217-currency-codes.html'>ISO 4217</a>.
    expense_amount_max:
      allOf:
        - $ref: ./fields.yaml#/amount
      description: |
        Maximum amount above which policy will be violated.
      example: 10000
    expense_amount_min:
      allOf:
        - $ref: ./fields.yaml#/amount
      description: |
        Minimum amount below which policy will be violated.
      example: 500
    expense_distance_max:
      allOf:
        - $ref: ./fields.yaml#/distance
      description: |
        Maximum travel distance allowed, above which policy will be violated.
      example: 10000
    expense_distance_min:
      allOf:
        - $ref: ./fields.yaml#/distance
      description: |
        Minimum travel distance allowed, below which policy will be violated.
      example: 500
    expense_category_ids:
      type: array
      items:
        $ref: './fields.yaml#/id_integer'
      description: |
          List of category ids targeted by this policy.
      example: [2222, 1221]
    expense_category_ids_op:
      $ref: ./fields.yaml#/in_operator
    expense_project_ids:
      type: array
      items:
        $ref: './fields.yaml#/id_integer'
      description: |
        List of project ids targeted by this policy.
      example: [1234, 5678]
    expense_project_ids_op:
      $ref: ./fields.yaml#/in_operator
    expense_cost_center_ids:
      type: array
      items:
        $ref: './fields.yaml#/id_integer'
      description: |
        List of cost centers ids targeted by this policy.
      example: [1987, 3456]
    expense_cost_center_ids_op:
      $ref: ./fields.yaml#/in_operator
    expense_allowed_exchange_rate_difference_percentage:
      type: number
      description: |
        Allowed percentage difference for exchange rates above which policy will be violated.
      example: 10
      minimum: 0
      maximum: 100
    expense_allowed_distance_difference_percentage:
      type: number
      description: |
        Allowed percentage difference for travel distance above which policy will be violated.
      example: 8
      minimum: 0
      maximum: 100
    expense_custom_fields:
      allOf:
        - $ref: './fields.yaml#/custom_fields'
      description: |
        Custom fields
    expense_custom_fields_op:
      type: object
      description: |
        Operator for the expense_custom_fields.
      properties:
        field_name:
          type: string
    expense_locations:
      description: |
        This field will be present for travel related categories.
        For travel between Place A to Place B, this array will contain two items, From location at array index 0 and To location at array index 1.
      type: array
      items:
        $ref: './fields.yaml#/location'
    expense_locations_op:
      $ref: ./fields.yaml#/in_operator
    expense_creation_delay_days_max:
      type: number
      example: 12
      description: |
        No of days from spent date after which if expense is created will violate policy.
    expense_on_holiday_allowed:
      type: boolean
      description: |
        Is expense on holiday allowed.
      example: True
    expense_without_receipt_allowed:
      type: boolean
      description: |
        Is expense without receipt allowed.
      example: True
    expense_spent_at_max:
      allOf:
        - $ref: './fields.yaml#/timestamptz_pst'
      description: |
        Expense having spent date greater than this date will violate policy.
    expense_spent_at_min:
      allOf:
        - $ref: './fields.yaml#/timestamptz_pst'
      description: |
        Expense having spent date lesser than this date will violate policy.
    expense_payment_modes:
      allOf:
        - $ref: ./fields.yaml#/policy_payment_modes
      description: |
        Payment mode for expense to be targeted in the policy.
    expense_payment_modes_op:
      $ref: ./fields.yaml#/in_operator
    expense_without_ccc_match_allowed:
      type: boolean
      description: |
        Is expense without Corporate Credit Card transaction match allowed.
      example: True
    expense_include_foreign_currency:
      type: boolean
      description: |
        Should policy run on expenses created in foreign currency.
      example: True
    expense_flight_travel_class:
      $ref: ./fields.yaml#/expense_policy_flight_travel_classes
    expense_train_travel_class:
      type: array
      description: >
        This field is applicable only for Train category.

        Index 0 holds onward journey travel class, index 1 holds return journey
        travel class.
      items:
        type: string
      example:
        - AC First Class
        - Second Sitting
    fiscal_year_start_month:
      type: number
      description: | 
        Month number of start of fiscal year.
      example: 4
      minimum: 1
      maximum: 12
    expense_vehicle_type:
      allOf:
        - $ref: ./fields.yaml#/vehicle_type
      description: |
        Vehicle type targeted by this policy.
    expense_annual_distance_max:
      type: number
      example: 1200
      description: |
        Maximum travel distance allowed, above which policy will be violated.
    employee_level_ids:
      type: array
      description: |
        Employee level ids targeted by this policy.
      items:
        type: string
      example:
        - lvl1sdfad
        - lvl2sdfas
    employee_level_ids_op:
      $ref: ./fields.yaml#/in_operator
    employee_custom_fields:
      allOf:
        - $ref: './fields.yaml#/custom_fields'
      description: |
        Custom fields
    employee_custom_fields_op:
      type: object
      description: |
        Operator for the employee_custom_fields.
      properties:
        field_name:
          type: string
    employee_department_ids:
      type: array
      description: |
        Employee department ids targeted by this policy.
      items:
        type: string
      example:
        - dept1asdfa
        - dept2adfad
    employee_department_id_op:
      $ref: ./fields.yaml#/in_operator
    employee_locations:
      description: |
        Location of employees targeted by this policy.
      type: array
      items:
        $ref: './fields.yaml#/location'
    employee_locations_op:
      $ref: ./fields.yaml#/in_operator
    employee_user_ids:
      type: array
      description: |
        Employee user ids targeted by this policy.
      items:
        type: string
      example:
        - usabcds1
        - usabcds2
    employee_user_ids_op:
      $ref: ./fields.yaml#/in_operator
    employee_titles:
      type: array
      description: |
        Employee titles targeted by this policy.
      items:
        type: string
      example:
        - CEO
        - Manager
    employee_titles_op:
      $ref: ./fields.yaml#/in_operator
    action_flag:
      type: boolean
      description: |
        Whether to flag the expense when it violates policy.
      example: True
    action_show_warning:
      type: boolean
      description: |
        Whether to show warning to employee when the expense that they are creating violates the policy.
      example: True
    action_make_unreportable:
      type: boolean
      description: |
        Whether to make the expense unreportable when it violates policy. <br>
        (Expense will be created but employee will not be able to add it to report).
      example: True
    action_remove_employee_approver1:
      type: boolean
      description: |
        Whether to remove the primary approver from the report when the expense violates policy.
      example: True
    action_add_employee_approver2:
      type: boolean
      description: |
        Whether to add secondary approver 1 as approver to report when the expense violates policy.
      example: True
    action_add_employee_approver3:
      type: boolean
      description: |
        Whether to add secondary approver 2 as approver to report when the expense violates policy.
      example: True
    action_add_project_approver1:
      type: boolean
      description: |
        Whether to add project approver 1 as approver to report when the expense violates policy.
      example: True
    action_add_project_approver2:
      type: boolean
      description: |
        Whether to add project approver 2 as approver to report when the expense violates policy.
      example: True
    action_add_department_head_approver:
      type: boolean
      description: |
        Whether to add department head as approver to report when the expense violates policy.
      example: True
    action_cap_amount:
      type: boolean
      description: |
        Whether to cap the amount to expense_amount_max when the expense violates policy.
      example: True
    action_add_approver_user_ids:
      type: array
      description: |
        List of approver user ids to be added to report when the expense violates policy.
      items:
        type: string
      example:
        - usabcds3
        - usabcds4
    action_override_distance_slab_rate:
      type: number
      description: |
        Override the distance slab rate with the set value when the expense violates policy.
      example: 20true